server:
  port: ${TRANSITLINK_PORT:8888}

spring:
  jackson:
    time-zone: UTC

  datasource:
    url: jdbc:postgresql://${TRANSITLINK_DB_HOST:localhost}:${TRANSITLINK_DB_PORT:5432}/${TRANSITLINK_DB_NAME:transitlink}
    username: ${TRANSITLINK_DB_USER}
    password: ${TRANSITLINK_DB_PASSWORD}
    driver-class-name: org.postgresql.Driver
    hikari:
      pool-name: HikariPool-TransitLink
      connection-init-sql: "SET time zone 'UTC';"
      maximum-pool-size: 20
      minimum-idle: 5
      idle-timeout: 60000
      connection-timeout: 3000
      max-lifetime: 1800000

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    open-in-view: false
    properties:
      hibernate.format_sql: true
      hibernate.dialect: org.hibernate.dialect.PostgreSQLDialect
      hibernate.jdbc.time_zone: UTC
      hibernate.jdbc.batch_size: 50
      hibernate.order_inserts: true
      hibernate.order_updates: true

  elasticsearch:
    uris: ${ELASTIC_SCHEMA:http}://${ELASTIC_HOST:localhost}:${ELASTIC_PORT:9200}
    username: elastic
    password: ${ELASTIC_PASSWORD}

  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD}

  mail:
    enabled: true
    host: ${SMTP_HOST}
    port: ${SMTP_PORT}
    username: ${SMTP_USER}
    password: ${SMTP_PASSWORD}
    from: "transitlink.com@gmail.com"
    properties:
      mail.smtp.auth: true
      mail.smtp.starttls.enable: true
      mail.smtp.connectionpoolsize: 10
      mail.smtp.connectiontimeout: 5000

  thymeleaf:
    prefix: classpath:/templates/
    suffix: .html
    mode: HTML
    encoding: UTF-8
    cache: false

  servlet:
    multipart:
      max-file-size: "50MB"
      max-request-size: "50MB"

  security:
    oauth2:
      client:
        registration:
          google:
            client-id: ${GOOGLE_CLIENT_ID}
            client-secret: ${GOOGLE_CLIENT_SECRET}
            scope:
              - openid
              - profile
              - email
management:
  endpoints:
    web:
      exposure:
        include: "health,info"
  endpoint:
    health:
      probes:
        enabled: true

logging:
  file:
    name: ${TRANSITLINK_WORKING_DIR:C:/transitlink}/logs/transitlink.log
  logback:
    rollingpolicy:
      max-file-size: "10MB"
      max-history: 7

app:
  storage:
    provider: ${TRANSITLINK_STORAGE_PROVIDER:local}
    root-path: ${TRANSITLINK_WORKING_DIR:C:/transitlink}/data
    base-url: ${TRANSITLINK_SCHEMA:http}://${TRANSITLINK_DOMAIN:localhost:8888}/files
  security:
    permit-all:
      - /swagger-ui/**
      - /v3/api-docs/**
      - /auth-dashboard.html
      - /files/**
      - /actuator/health
      - /actuator/info
      - /login/oauth2/**
      - /api/identity/auth/**
      - /oauth2/**
    cors:
      allowed-origins:
        - "http://localhost:4200"
        - "http://localhost:8888"
        - "https://transitlink.dpdns.org"
        - "http://api.transitlink.fpt.edu.vn"
        - "https://api.transitlink.dpdns.org"
      allowed-methods:
        - GET
        - POST
        - PUT
        - DELETE
        - OPTIONS
      allowed-headers:
        - "*"
      allow-credentials: true
    jwt:
      secret: ${JWT_SECRET}
      access-token:
        expiration: 900000 # 15 phút (ms)
      refresh-token:
        expiration: 604800000 # 7 ngày (ms)
    oauth2:
      redirect-uris:
        - http://localhost:4200/oauth/callback
    verification:
      otp-expiration-minutes: 5
    frontend:
      base-url: "http://localhost:4200"

mapbox:
  access-token: ${MAPBOX_ACCESS_TOKEN}

# SpringDoc configuration for API documentation
springdoc:
  api-docs:
    enabled: true # change false to disable API docs on production

  swagger-ui:
    enabled: true # change false to disable Swagger UI on production
    operations-sorter: method
    tags-sorter: alpha

  info:
    title: TransitLink API
    version: 1.0.0
    description: API documentation for the TransitLink application

  servers:
    - url: http://localhost:8888
      description: Local development server
    - url: http://api.transitlink.fpt.edu.vn
      description: Containerized deployment server
    - url: https://api.transitlink.dpdns.org
      description: Production server

  groups:
    - group: identity
      paths: /api/identity/**
    - group: location
      paths: /api/location/**
    - group: fleet
      paths: /api/fleet/**
    - group: storage
      paths: /api/storage/**